{% extends "funix/problem/problem-base.html" %} {% block problem_media %} {% if
request.user.is_authenticated %} {{ form.media.css }}
<link rel="stylesheet" href="{{ static('funix/css/lib/jquery-ui.css') }}" />
<link rel="stylesheet" href="{{ static('plugins/css/resizable.min.css') }}" />

<link
  rel="stylesheet"
  href="{{ static('funix/css/problem/main-right.css') }}"
/>

{% if is_html %}
<link
  rel="stylesheet"
  href="{{ static('funix/css/problem/html-preview.css') }}"
/>
{% endif %} {% if submissions %}
<link
  rel="stylesheet"
  href="{{ static('funix/css/problem/submission-history.css') }}"
/>
{% endif %} {% endif %} {% endblock %} {% block problem_js_media %} {% if
request.user.is_authenticated %}
<script src="https://code.jquery.com/ui/1.13.2/jquery-ui.js"></script>
<script
  src="{{static('plugins/js/resizable.min.js')}}"
  type="text/javascript"
></script>
<script type="text/javascript" src="{{ ACE_URL }}/ace.js"></script>
{{ form.media.js }}
<script type="text/javascript" src="{{ static('event.js') }}"></script>
{% include 'funix/problem/ace-editor.html' %} {% include
"funix/problem/js-resizing.html" %} {% if submission and not
submission.is_graded and last_msg %} {% include "funix/problem/js-event.html" %}
{% endif %} {% endif %} {% endblock %} {% block problem_main %} {% if
request.user.is_authenticated %} {% if is_html %} {% include
"funix/problem/description.html" %}
<div id="main-right" style="display: flex">
  {% include 'funix/problem/editor.html' %}
</div>
{% include "funix/submission/history.html" %} {% if request.user.is_staff or
request.user.is_superuser %} {% include "funix/problem/solution.html" %} {%
endif %} {% else %}
<div id="main-left">
  {% include "funix/problem/description.html" %} {% include
  "funix/submission/history.html" %} {% if request.user.is_staff or
  request.user.is_superuser %} {% include "funix/problem/solution.html" %} {%
  endif %}
</div>

<div id="main-right" style="flex: 1">
  {% include 'funix/problem/editor.html' %}
</div>
{% endif %} {% if submission and not submission.is_graded and (request.user ==
submission.user.user or perms.judge.abort_any_submission) %}
<div id="loading-modal" class="backdrop">
  <div style="min-width: 500px" class="modal">
    <p style="text-align: center; font-size: 20px">{{ _('Judging') }}</p>

    <div style="display: flex; align-items: center; justify-content: center">
      <div class="lds-dual-ring"></div>
    </div>

    <form
      style="
        display: flex;
        align-items: center;
        justify-content: center;
        padding-top: 20px;
      "
      action="{{ url('beta_submission_abort', submission.id) }}{% if iframe and iframe == '1' %}{{'?iframe=1'}}{% endif %}"
      method="post"
      title="{{ _('Press Ctrl-Enter or Command-Enter to abort.') }}"
    >
      {% csrf_token %}
      <input type="submit" value="{{ _('Abort') }}" class="button" />
    </form>
  </div>
</div>
{% endif %}

<div id="success-modal" class="backdrop d-none">
  <div class="modal">
    <div style="display: flex; align-items: center; justify-content: center">
      <img
        src="{{ static('funix/images/congratulations.svg') }}"
        alt="Congratulations"
      />
    </div>

    <p style="font-size: 20px; text-align: center; margin: 5px 0 5px">
      {{ _('Congratulations') }}
    </p>
    <p style="font-size: 20px; text-align: center; margin: 10px 0 10px">
      <b>{{ request.user.username }}!</b>
    </p>
    <p style="font-size: 15px; text-align: center">
      {{ _('You have just finished this problem') }}
    </p>
    <div
      style="
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 20px;
      "
    >
      <button onclick="$('#success-modal').remove()" class="button">
        {{ _('Close') }}
      </button>
    </div>
  </div>
</div>

{% else %} {% include "funix/problem/description.html" %} {% include
"funix/problem/required-login-modal.html" %} {% endif %} {% endblock %} {% block
problem_js_end %} {% if request.user.is_authenticated %} {% if is_html %}
<script type="text/javascript">
  function update_iframe_height() {
    const iframe = document.querySelector("#html-preview iframe");
    iframe.style.height = 0;
    iframe.style.height =
      iframe.contentWindow.document.documentElement.scrollHeight + 20 + "px";
  }
</script>
{% endif %}

<script type="text/javascript">
  function clear_editor() {
    var source = $("textarea#id_source");
    source.val(window.initial_code);
    window.ace_source.getSession().setValue(window.initial_code);
  }
</script>

{% if is_html %}
<script type="text/javascript">
  function toggle_editor(event) {
    if (
      document
        .getElementById("toggle-editor-button")
        .classList.contains("expand")
    ) {
      document
        .getElementById("toggle-editor-button")
        .classList.remove("expand");
      document.getElementById("html-preview").classList.remove("d-none");
    } else {
      document.getElementById("toggle-editor-button").classList.add("expand");
      document.getElementById("html-preview").classList.add("d-none");
    }
  }
</script>
{% else %}
<script type="text/javascript">
  function toggle_editor(event) {
    if (
      document
        .getElementById("toggle-editor-button")
        .classList.contains("expand")
    ) {
      document
        .getElementById("toggle-editor-button")
        .classList.remove("expand");
      document.getElementById("main-left").classList.remove("d-none");
    } else {
      document.getElementById("toggle-editor-button").classList.add("expand");
      document.getElementById("main-left").classList.add("d-none");
    }
  }
</script>
{% endif %} {% if is_html and submission and not submission.is_graded and
(request.user == submission.user.user or perms.judge.abort_any_submission) %}
<script type="text/javascript">
  $("#beta-container").tabs({
    active: 1,
  });
</script>
{% else %}
<script type="text/javascript">
  $("#beta-container").tabs();
</script>
{% endif %}

<script type="text/javascript">
  $("#testcases").tabs();
  $(".testcases-and-submission").tabs();
</script>
{% endif %} {% endblock %}
