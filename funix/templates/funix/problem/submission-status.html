<link rel="stylesheet" href="{{ static('funix/css/submission-status.css') }}" />

{% if submission.contest_or_none %} {% set prefix_length =
submission.contest_or_none.problem.output_prefix_override %} {% else %} {% set
prefix_length = None %} {% endif %} {% set is_pretest = submission.is_pretested
%} {% if submission.status != 'IE' %} {% if submission.status == 'QU' %}
<h4>
  {{ _('We are waiting for a suitable judge to process your submission...') }}
</h4>
{% elif submission.status == 'P' %}
<h4>{{ _('Your submission is being processed...') }}</h4>
{% elif submission.status == 'CE' %}
<h3>{{ _('Compilation Error') }}</h3>
<pre>{{ submission.error|ansi2html }}</pre>
{% else %} {% if submission.error %}
<h3>{{ _('Compilation Warnings') }}</h3>
<pre>{{ submission.error|ansi2html }}</pre>
<hr class="half-hr" />
<br />
{% endif %} {% if is_pretest %}
<h3>{{ _('Pretest Execution Results') }}</h3>
{% else %}
<h3>{{ _('Execution Results') }}</h3>
{% endif %}
<br />

{% if statuses or not submission.is_graded %} {% for case in statuses %} {% if
case.status == "AC" %}
<span class="fa fa-check case-AC"></span>
{% elif case.status == "SC" %}
<span class="case-SC">&ndash;</span>
{% else %}
<a href="#{{ case.id }}">
  <span class="fa fa-times case-{{ case.status }} case-bad"></span>
</a>
{% endif %} {% if case.num_combined > 1 %}
<sup class="case-{{ case.status }}">&times;{{ case.num_combined }}</sup>
{% endif %} {% endfor %} {% if not submission.is_graded %}
<span class="fa fa-spinner fa-pulse"></span>
{% endif %}
<br /><br />
{% endif %} {% if submission.is_graded %}
<br />
{% if submission.result != "AB" %}
<b>{{ _('Resources:') }}</b>
{% if submission.result == "TLE" %}
<span>---,</span>
{% else %}
<span title="{{ submission.time }}s"
  >{{ submission.time|floatformat(3) }}s,</span
>
{% endif %} {{ submission.memory|kbdetailformat }}
<br />
{% if submission.result == "AC" %}
<b>{{ _('Maximum single-case runtime:') }}</b>
<h3>max_execution_time</h3>
<br />
{% endif %} {% if is_pretest %}
<b>{{ _('Final pretest score:') }}</b>
{% else %}
<b>{{ _('Final score:') }}</b>
{% endif %} {{ submission.case_points|floatformat(0) }}/{{
submission.case_total|floatformat(0) }} {% if request.in_contest and
submission.contest_or_none %} {% with contest=submission.contest_or_none %} {%
set points=contest.points|roundfloat(3) %} {% set
total=contest.problem.points|floatformat(-1) %} ({{ _('%(points)s/%(total)s
points', points=points, total=total) }}) {% endwith %} {% else %} {% with
points=submission.points|roundfloat(3),
total=submission.problem.points|floatformat(-1) %} ({{ _('%(points)s/%(total)s
points', points=points, total=total) }}) {% endwith %} {% endif %} {% if
is_pretest and submission.result == "AC" %}
<br />
<i
  >{{ _('Passing pretests does not guarantee a full score on system tests.')
  }}</i
>
{% endif %} {% else %}
<b>{{ _('Submission aborted!') }}</b>
{% endif %}
<br />
{% endif %} {% set test_case_id = counter() %}
<ul class="testcases_container">
  {% for batch in batches %} {% if batch.id %}
  <li class="testcase">
    <p class="testcase_title">
      <b>{{ _('Batch #%(id)d', id=test_case_id()) }}</b>
      ({{ _('%(points)s/%(total)s points', points=batch.points|floatformat(0),
      total=batch.total|floatformat(0)) }})
    </p>
    <ul class="subcases">
      {% endif %} {% for case in batch.cases %}
      <li
        class="{% if batch.id is none %}{{'testcase'}}{% else %}{{'subcase'}}{% endif %}"
      >
        {% set print_case_output = case.status != 'AC' and case.output and
        (prefix_length is none or prefix_length > 0) %}
        <div id="{{ case.id }}" class="case-row toggle closed">
          <div
            class="{% if batch.id %}{{'subcase_title'}}{% else %}{{'testcase_title'}}{% endif %}"
          >
            {%- if batch.id -%}
            <b>{{ _('Case #%(id)d:', id=loop.index) }}</b>
            {%- elif is_pretest -%}
            <b>{{ _('Pretest #%(id)d:', id=test_case_id()) }}</b>
            {%- else -%}
            <b>{{ _('Test case #%(id)d:', id=test_case_id()) }}</b>
            {%- endif -%}

            <div class="mainstatus">
              <p>
                <span
                  title="{{ case.long_status }}"
                  class="case-{{ case.result_class }}"
                >
                  {%- if case.status == 'SC' %}&mdash;{% else %}{{ case.status
                  }}{% endif -%}
                </span>
                {%- if case.feedback %}&nbsp;({{ case.feedback }}){% endif -%}
              </p>

              <p>
                {%- if case.status != 'SC' -%} {%- if case.status == 'TLE' -%}
                [&gt;<span>{{ time_limit|floatformat(3) }}s,</span>
                {%- else -%}
                <span title="{{ case.time }}s"
                  >{{ case.time|floatformat(3) }}s,</span
                >
                {%- endif -%} {%- endif -%}
              </p>

              <p>
                {% if case.status != 'SC' %}{{ case.memory|kbdetailformat }}{%
                endif %}
              </p>

              {% if not batch.id %}
              <p>
                ({{ case.points|floatformat(0) }}/{{ case.total|floatformat(0)
                }}) points
              </p>
              {% endif %}
            </div>
          </div>
        </div>

        {% if print_case_output or case.extended_feedback %} {% if
        print_case_output %}

        <div class="your_output">
          <p class="togglebutton" onclick="toggle(event)">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="w-6 h-6"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M8.25 4.5l7.5 7.5-7.5 7.5"
              />
            </svg>
            {{ _('Your output (clipped)') }}:
          </p>
          {% if prefix_length is none %}
          <div>
            <pre class="case-output">{{ case.output|linebreaksbr }}</pre>
          </div>
          {% else %}
          <div>
            <pre class="case-output">
{{ case.output[:prefix_length]|linebreaksbr }}</pre
            >
          </div>
          {% endif %}
        </div>

        {% endif %} {% if case.extended_feedback %}
        <div class="case-info">
          <p><b>judge feed back</b></p>
          <strong>{{ _('Judge feedback') }}</strong>
          <pre class="case-output">
{{ case.extended_feedback|linebreaksbr }}</pre
          >
        </div>
        {% endif %} {% endif %}
      </li>
      {% endfor %} {% if batch.id %}
    </ul>
    {% endif %} {% endfor %}
  </li>
</ul>

{% endif %} {% else %} {% include "submission/internal-error-message.html" %} {%
endif %}

<script type="text/javascript">
  const toggle = (event) => {
    event.target.classList.toggle("show");
  };
</script>
